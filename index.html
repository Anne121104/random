<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Y√™u ƒêi ƒê√¢u? - V√≤ng quay l·ª±a ch·ªçn ng·∫´u nhi√™n & Qu·∫£n l√Ω danh s√°ch</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: #ffe6f0; /* h·ªìng pastel n·ªÅn */
      color: #6a3650; /* h·ªìng t√≠m ƒë·∫≠m */
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
      text-align: center;
      overflow-x: hidden;
      position: relative;
    }
    header {
      margin-bottom: 20px;
      margin-top: 20px;
      position: relative;
      z-index: 10;
    }
    header h1 {
      font-size: 2.6rem;
      margin: 0;
      color: #d94f77; /* h·ªìng ƒë·∫≠m */
      letter-spacing: 1.5px;
      font-weight: 700;
      position: relative;
      z-index: 10;
    }
    header p {
      font-size: 1.1rem;
      color: #a15a71;
      margin-top: 6px;
      position: relative;
      z-index: 10;
      margin-bottom: 15px;
    }
    .heart-icon {
      display: inline-block;
      margin-left: 10px;
      vertical-align: middle;
      color: #d94f77;
      font-size: 2rem;
      animation: heartbeat 1.5s infinite;
      user-select: none;
      position: relative;
      z-index: 10;
    }
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    /* Tim l·∫•p l√°nh animation */
    .sparkle {
      position: absolute;
      width: 14px;
      height: 14px;
      background: #f48fb1;
      box-shadow:
        0 0 10px 3px #f48fb1,
        inset 0 0 6px 2px #fff5f9;
      border-radius: 50%;
      animation: sparkleAnim 2.5s infinite ease-in-out;
      pointer-events: none;
      filter: drop-shadow(0 0 2px #f48fb1);
    }
    @keyframes sparkleAnim {
      0%, 100% { opacity: 1; transform: scale(1) rotate(0deg); }
      50% { opacity: 0.4; transform: scale(0.6) rotate(45deg); }
    }

    /* Hai icons m√®o v√† c√∫n chibi */
    .chibi-cat, .chibi-dog {
      position: absolute;
      width: 80px;
      height: auto;
      user-select: none;
      pointer-events: none;
      filter: drop-shadow(0 1px 3px rgba(0,0,0,0.15));
      z-index: 5;
    }
    .chibi-cat {
      top: 18px;
      left: 12px;
      animation: floatUpDown 4s ease-in-out infinite;
    }
    .chibi-dog {
      top: 18px;
      right: 12px;
      animation: floatUpDown 5s ease-in-out infinite;
      animation-delay: 2s;
    }
    @keyframes floatUpDown {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(8px); }
    }

    /* Main container */
    main {
      background: #fff0f6;
      border-radius: 18px;
      box-shadow: 0 6px 14px rgba(217, 79, 119, 0.3);
      padding: 30px 25px;
      max-width: 460px;
      width: 100%;
      margin-bottom: 40px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      position: relative;
      z-index: 10;
    }

    /* N√∫t lo·∫°i ch·ªçn ban ƒë·∫ßu */
    .btn-group {
      display: flex;
      width: 100%;
      gap: 20px;
      justify-content: center;
    }
    button.choiceBtn {
      background: #d94f77;
      color: #fff;
      padding: 14px 20px;
      border: none;
      border-radius: 30px;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 6px 12px rgba(217, 79, 119, 0.6);
      user-select: none;
      flex: 1;
      max-width: 180px;
      white-space: nowrap;
    }
    button.choiceBtn:hover {
      background: #e46794;
      box-shadow: 0 8px 18px rgba(228, 103, 148, 0.8);
    }
    button.choiceBtn:active {
      background: #bf3f61;
      box-shadow: 0 4px 8px rgba(191, 63, 97, 0.9);
      transform: translateY(2px);
    }

    /* N√∫t quay b√°nh xe */
    button#spinBtn {
      margin-top: 15px;
      background: #d94f77;
      color: #fff;
      padding: 14px 36px;
      border: none;
      border-radius: 30px;
      font-weight: 700;
      font-size: 1.25rem;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(217, 79, 119, 0.6);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
      width: 50%;
      max-width: 200px;
      user-select: none;
    }
    button#spinBtn:hover:not(:disabled) {
      background: #e46794;
      box-shadow: 0 8px 18px rgba(228, 103, 148, 0.8);
    }
    button#spinBtn:active:not(:disabled) {
      background: #bf3f61;
      box-shadow: 0 4px 8px rgba(191, 63, 97, 0.9);
      transform: translateY(2px);
    }
    button#spinBtn:disabled {
      background: #ce7d96;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* V√πng ch·ª©a b√°nh xe */
    #wheel-container {
      position: relative;
      width: 320px;
      height: 320px;
      margin-top: 10px;
    }
    #wheelcanvas {
      border-radius: 50%;
      box-shadow: 0 4px 10px rgba(217, 79, 119, 0.3);
    }

    /* M≈©i t√™n ch·ªâ b√°nh xe*/
    #pointer {
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 30px solid #d94f77; 
      position: absolute;
      bottom: 320px; 
      left: calc(50% - 20px);
      filter: drop-shadow(0 2px 3px rgba(191, 63, 97, 0.6));
      z-index: 20;
      transition: border-color 0.3s ease;
    }
    #pointer:hover {
      border-top-color: #e46794;
      cursor: pointer;
    }

    /* Tab ch√∫c m·ª´ng */
    #result-tab {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      max-width: 90vw;
      background: #ffd1e3;
      border-radius: 18px;
      padding: 20px 30px;
      box-shadow: 0 5px 18px rgba(217, 79, 119, 0.7);
      color: #d94f77;
      font-weight: 700;
      font-size: 1.4rem;
      display: none;
      user-select: none;
      z-index: 9999;
      text-align: center;
      animation: fadeInPopup 0.4s ease forwards;
      white-space: nowrap;
    }

    @keyframes fadeInPopup {
      from {opacity: 0; transform: translateX(-50%) translateY(-10px);}
      to {opacity: 1; transform: translateX(-50%) translateY(0);}
    }

    /* N√∫t quay l·∫°i */
    #backBtn {
      margin-top: 20px;
      background: #d94f77;
      color: white;
      border: none;
      border-radius: 30px;
      padding: 12px 28px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(217, 79, 119,0.6);
      transition: background-color 0.3s ease;
      width: 50%;
      max-width: 160px;
      user-select: none;
    }
    #backBtn:hover {
      background: #e46794;
    }
    #backBtn:active {
      background: #bf3f61;
      transform: translateY(2px);
    }

    /* Responsive */
    @media (max-width: 460px) {
      main {
        max-width: 90vw;
        padding: 25px 15px;
      }
      #wheel-container {
        width: 280px;
        height: 280px;
      }
      #pointer {
        left: calc(50% - 16px);
        border-left: 16px solid transparent;
        border-right: 16px solid transparent;
        border-top: 24px solid #d94f77;
        bottom: -24px;
      }
      #spinBtn, #backBtn {
        width: 70%;
        max-width: none;
      }
      button.choiceBtn {
        font-size: 1rem;
      }
    }

    /* Ph·∫ßn qu·∫£n l√Ω danh s√°ch */
    #manage-section {
      width: 100%;
      margin-top: 30px;
      background: #ffe0ef;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(217, 79, 119, 0.25);
      color: #6a3650;
      text-align: left;
      font-size: 0.96rem;
    }

    #manage-section h3 {
      margin: 0 0 12px 0;
      font-weight: 700;
      color: #d94f77;
      font-size: 1.3rem;
      user-select: none;
    }

    /* Danh s√°ch m·ª•c */
    #item-list {
      list-style: none;
      padding: 0;
      margin: 0 0 12px 0;
      max-height: 130px;
      overflow-y: auto;
      border: 1px solid #d94f77;
      border-radius: 8px;
      background: #fff0f6;
    }

    #item-list li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 12px;
      border-bottom: 1px solid #d094b9;
      user-select: none;
    }
    #item-list li:last-child {
      border-bottom: none;
    }

    #item-list li span.text-item {
      flex: 1;
      font-weight: 600;
      color: #6a3650;
      cursor: default;
      word-break: break-word;
    }

    /* N√∫t s·ª≠a, x√≥a */
    .btn-edit, .btn-delete {
      background: #d94f77;
      border: none;
      color: white;
      padding: 4px 10px;
      margin-left: 6px;
      border-radius: 20px;
      font-size: 0.85rem;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    .btn-edit:hover {
      background: #e46794;
    }
    .btn-delete:hover {
      background: #bf3f61;
    }

    /* Form th√™m/s·ª≠a */
    #edit-form {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    #edit-input {
      flex: 1 1 auto;
      font-size: 1rem;
      padding: 8px 12px;
      border-radius: 20px;
      border: 2px solid #d94f77;
      outline-offset: 2px;
      color: #6a3650;
      font-weight: 600;
    }
    #edit-input:focus {
      outline-color: #e46794;
      border-color: #e46794;
    }
    #saveBtn, #cancelBtn {
      background: #d94f77;
      color: white;
      border: none;
      border-radius: 30px;
      padding: 10px 22px;
      font-weight: 700;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
      flex: 0 0 auto;
    }
    #saveBtn:hover {
      background: #e46794;
    }
    #cancelBtn {
      background: #bf3f61;
    }
    #cancelBtn:hover {
      background: #a23653;
    }

    /* N√∫t th√™m m·ªõi */
    #addItemBtn {
      background: #d94f77;
      border: none;
      border-radius: 30px;
      color: white;
      padding: 10px 24px;
      font-weight: 700;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
      margin-bottom: 12px;
      width: 100%;
      max-width: 180px;
      align-self: center;
    }
    #addItemBtn:hover {
      background: #e46794;
    }
  </style>
</head>
<body>

  <!-- H√¨nh chibi m√®o v√† c√∫n cute b√™n tr√™n -->
  <img src="c:\heheheheheheeehhe\hellooo kitty.jpg" alt="M√®o chibi cute" class="chibi-cat" width="80" height="80" />
  <img src="c:\heheheheheheeehhe\kh√≥c nh√®.jpg" alt="C√∫n chibi cute" class="chibi-dog" width="80" height="80" />

  <!-- Tim l·∫•p l√°nh -->
  <div class="sparkle" style="top:10px; left: 60px; animation-delay: 0s;"></div>
  <div class="sparkle" style="top: 45px; left: 130px; animation-delay: 1s;"></div>
  <div class="sparkle" style="top: 25px; right: 130px; animation-delay: 1.5s;"></div>
  <div class="sparkle" style="top: 70px; right: 65px; animation-delay: 2.3s;"></div>
  <div class="sparkle" style="top: 90px; left: 200px; animation-delay: 2.7s;"></div>

  <header>
    <h1>B√© C√∫n ƒêi ƒê√¢u ƒê√¢y? <span class="heart-icon">‚ù§Ô∏è</span></h1>
    <p>Ch·ªçn n∆°i ƒëi ch∆°i ho·∫∑c m√≥n ƒÉn ng·∫´u nhi√™n ƒë√≥a cho ƒë·ª° ph·∫£i ph√¢n v√¢n hehe</p>
  </header>

  <main>
    <!-- M√†n h√¨nh ch·ªçn lo·∫°i -->
    <div id="selection-screen" >
      <div class="btn-group" role="group" aria-label="Ch·ªçn lo·∫°i g·ª£i √Ω">
        <button class="choiceBtn" id="btnPlace" aria-pressed="false" aria-label="Ch·ªçn n∆°i ƒëi ch∆°i">Ch·ªçn N∆°i ƒêi Ch∆°i</button>
        <button class="choiceBtn" id="btnFood" aria-pressed="false" aria-label="Ch·ªçn m√≥n ƒÉn">Ch·ªçn M√≥n ƒÇn</button>
      </div>
    </div>

    <!-- M√†n h√¨nh v√≤ng quay -->
    <div id="wheel-screen" style="display:none; flex-direction: column; align-items: center;">

      <div id="wheel-container">
        <canvas id="wheelcanvas" width="320" height="320" aria-label="V√≤ng quay ch·ªçn ng·∫´u nhi√™n"></canvas>
        <div id="pointer" role="img" aria-label="M≈©i t√™n ch·ªâ v√≤ng quay"></div>
      </div>
      <button id="spinBtn" aria-label="Quay v√≤ng quay ng·∫´u nhi√™n">Quay!</button>
      <button id="backBtn" style="display:none;" aria-label="Quay l·∫°i ch·ªçn lo·∫°i">Quay l·∫°i</button>
      <div id="result-tab" role="alert" aria-live="assertive"></div>

      <!-- Ph·∫ßn qu·∫£n l√Ω danh s√°ch -->
      <section id="manage-section" aria-label="Qu·∫£n l√Ω danh s√°ch n·ªôi dung v√≤ng quay">
        <h3>Qu·∫£n l√Ω danh s√°ch <span id="current-type-name"></span></h3>
        <button id="addItemBtn" aria-label="Th√™m m·ª•c m·ªõi">+ Th√™m m·ª•c m·ªõi</button>

        <ul id="item-list" aria-live="polite">
          <!-- Danh s√°ch item hi·ªÉn th·ªã ·ªü ƒë√¢y -->
        </ul>

        <!-- Form th√™m / s·ª≠a -->
        <form id="edit-form" style="display:none;" aria-label="Form th√™m ch·ªânh s·ª≠a m·ª•c">
          <input type="text" id="edit-input" aria-required="true" placeholder="Nh·∫≠p n·ªôi dung..." />
          <button type="submit" id="saveBtn" aria-label="L∆∞u m·ª•c">L∆∞u</button>
          <button type="button" id="cancelBtn" aria-label="H·ªßy thao t√°c">H·ªßy</button>
        </form>
      </section>
    </div>
  </main>

  <footer>
    &copy; 2024 - Choa Hnguyn thuisiii thuisiiiii v√† TA th∆∞m tho s·∫°ch s·∫ª
  </footer>

  <script>
    // Khai b√°o localStorage keys
    const STORAGE_KEYS = {
      place: 'yeu_di_dau_places',
      food: 'yeu_di_dau_foods'
    };

    // D·ªØ li·ªáu m·∫∑c ƒë·ªãnh
    const defaultPlaces = [
      "Caf√© s√°ch Tranquil Books",
      "Ph·ªë c·ªï H√† N·ªôi",
      "H·ªì G∆∞∆°m",
      "C√¥ng vi√™n Th·ªëng Nh·∫•t",
      "LƒÉng B√°c",
      "Ch·ª£ ƒê·ªìng Xu√¢n",
      "Ch√πa Tr·∫•n Qu·ªëc",
      "B·∫£o t√†ng D√¢n t·ªôc h·ªçc Vi·ªát Nam",
      "Trung t√¢m th∆∞∆°ng m·∫°i Vincom B√† Tri·ªáu",
      "Leo n√∫i B√°t Tr√†ng"
    ];
    const defaultFoods = [
      "Ph·ªü H√† N·ªôi",
      "B√∫n ch·∫£",
      "Ch·∫£ c√° L√£ V·ªçng",
      "Nem r√°n",
      "B√°nh cu·ªën Thanh Tr√¨",
      "B√∫n thang",
      "X√¥i x√©o",
      "Ch√® b√† Th·ª´a",
      "Tr√† chanh H√† N·ªôi",
      "B√°nh t√¥m H·ªì T√¢y"
    ];

    // Bi·∫øn to√†n c·ª•c ƒë·ªÉ theo d√µi tr·∫°ng th√°i
    let currentItems = [];
    let currentType = null; // "place" ho·∫∑c "food"
    let startAngle = 0;
    let arc = 0;
    let spinTimeout = null;
    let spinArcStart = 0;
    let spinTime = 0;
    let spinTimeTotal = 0;
    let spinning = false;
    let selectedIndex = -1;
    let editingIndex = -1;

    // DOM elements
    const btnPlace = document.getElementById('btnPlace');
    const btnFood = document.getElementById('btnFood');
    const selectionScreen = document.getElementById('selection-screen');
    const wheelScreen = document.getElementById('wheel-screen');
    const spinBtn = document.getElementById('spinBtn');
    const backBtn = document.getElementById('backBtn');
    const resultTab = document.getElementById('result-tab');
    const wheelcanvas = document.getElementById('wheelcanvas');
    const ctx = wheelcanvas.getContext('2d');

    const manageSection = document.getElementById('manage-section');
    const itemList = document.getElementById('item-list');
    const addItemBtn = document.getElementById('addItemBtn');
    const editForm = document.getElementById('edit-form');
    const editInput = document.getElementById('edit-input');
    const saveBtn = document.getElementById('saveBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const currentTypeName = document.getElementById('current-type-name');

    // M√†u pastel cho t·ª´ng ph·∫ßn b√°nh xe
    const pastelColors = [
      "#f9c2d6", "#f4a6c0", "#e48ba9", "#db6d94",
      "#cd537a", "#b93c68", "#a7305a", "#9e2853",
      "#98304e", "#91294b"
    ];

    // L·∫•y d·ªØ li·ªáu t·ª´ localStorage ho·∫∑c m·∫∑c ƒë·ªãnh
    function loadData(type) {
      let data = localStorage.getItem(STORAGE_KEYS[type]);
      if (!data) {
        data = (type === 'place') ? defaultPlaces : defaultFoods;
        localStorage.setItem(STORAGE_KEYS[type], JSON.stringify(data));
        return data;
      }
      try {
        return JSON.parse(data);
      } catch {
        // l·ªói parse d·ªØ li·ªáu
        return (type === 'place') ? defaultPlaces : defaultFoods;
      }
    }

    // L∆∞u d·ªØ li·ªáu v√†o localStorage
    function saveData(type, data) {
      localStorage.setItem(STORAGE_KEYS[type], JSON.stringify(data));
    }

    // V·∫Ω b√°nh xe d·ª±a tr√™n currentItems
    function drawWheel() {
      const outsideRadius = 140;
      const textRadius = 100;
      const insideRadius = 40;
      arc = (2 * Math.PI) / currentItems.length;
      ctx.clearRect(0, 0, wheelcanvas.width, wheelcanvas.height);

      ctx.strokeStyle = "#d94f77";
      ctx.lineWidth = 2;

      ctx.font = 'bold 12px Poppins, sans-serif'; // ch·ªØ nh·ªè v·ª´a ƒë·ªß
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";

      for (let i = 0; i < currentItems.length; i++) {
        const angle = startAngle + i * arc;

        // T√¥ m√†u
        ctx.fillStyle = pastelColors[i % pastelColors.length];
        ctx.beginPath();
        ctx.arc(wheelcanvas.width / 2, wheelcanvas.height / 2, outsideRadius, angle, angle + arc, false);
        ctx.arc(wheelcanvas.width / 2, wheelcanvas.height / 2, insideRadius, angle + arc, angle, true);
        ctx.closePath();
        ctx.fill();
        ctx.stroke();

        // V·∫Ω ch·ªØ v·ªõi chia 2 d√≤ng n·∫øu d√†i
        ctx.save();
        ctx.fillStyle = "#6a3650";
        ctx.translate(
          wheelcanvas.width / 2 + Math.cos(angle + arc / 2) * textRadius,
          wheelcanvas.height / 2 + Math.sin(angle + arc / 2) * textRadius
        );
        ctx.rotate(angle + arc / 2 + Math.PI / 2);

        let text = currentItems[i];
        if (text.length > 15) {
          const mid = Math.floor(text.length / 2);
          let cutIndex = text.indexOf(' ', mid);
          if (cutIndex === -1) cutIndex = mid;
          const line1 = text.slice(0, cutIndex);
          const line2 = text.slice(cutIndex).trim();

          ctx.fillText(line1, 0, -8);
          ctx.fillText(line2, 0, 10);
        } else {
          ctx.fillText(text, 0, 0);
        }
        ctx.restore();
      }
    }

    // easing gi·∫£m t·ªëc
    function easeOut(t, b, c, d) {
      return c*((t=t/d-1)*t*t + 1) + b;
    }

    // Quay b√°nh xe (gi·∫£ l·∫≠p easing gi·∫£m t·ªëc)
    function rotateWheel() {
      spinTime += 30;
      if (spinTime >= spinTimeTotal) {
        stopRotateWheel();
        return;
      }
      const spinAngle = spinArcStart - easeOut(spinTime, 0, spinArcStart, spinTimeTotal);
      startAngle += (spinAngle * Math.PI / 180);
      drawWheel();
      spinTimeout = setTimeout(rotateWheel, 30);
    }

    // Khi d·ª´ng quay cho k·∫øt qu·∫£
    function stopRotateWheel() {
      clearTimeout(spinTimeout);
      const degrees = startAngle * 180/Math.PI + 90;
      const arcd = arc * 180/Math.PI;
      let index = Math.floor((360 - (degrees % 360)) / arcd);
      index = index >= currentItems.length ? index - currentItems.length : index;
      selectedIndex = index;

      // Hi·ªÉn th·ªã k·∫øt qu·∫£
      resultTab.style.display = "block";
      resultTab.textContent = `üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ ch·ªçn: "${currentItems[selectedIndex]}" üéâ`;
      spinBtn.disabled = false;
      backBtn.style.display = "inline-block";
      spinning = false;
    }

    // B·∫Øt ƒë·∫ßu quay
    function startSpin() {
      if (spinning) return;
      if (currentItems.length === 0) {
        alert('Danh s√°ch hi·ªán t·∫°i ƒëang tr·ªëng. Vui l√≤ng th√™m m·ª•c m·ªõi tr∆∞·ªõc khi quay!');
        return;
      }
      spinBtn.disabled = true;
      resultTab.style.display = "none";
      spinning = true;
      spinArcStart = Math.floor(Math.random() * 360) + 360 * 3;
      spinTime = 0;
      spinTimeTotal = Math.floor(Math.random() * 2000) + 4000;
      rotateWheel();
    }

    // Hi·ªÉn th·ªã m√†n h√¨nh v√≤ng quay & qu·∫£n l√Ω v·ªõi danh s√°ch d·ªØ li·ªáu
    function showWheelScreen(type) {
      currentType = type;
      currentItems = loadData(currentType);
      currentTypeName.textContent = (type === 'place') ? 'N∆°i ƒëi ch∆°i' : 'M√≥n ƒÉn';
      startAngle = 0;
      selectedIndex = -1;
      editingIndex = -1;
      drawWheel();
      spinBtn.disabled = false;
      resultTab.style.display = "none";
      backBtn.style.display = "none";
      selectionScreen.style.display = "none";
      wheelScreen.style.display = "flex";
      manageSection.style.display = "block";

      editForm.style.display = "none";
      addItemBtn.style.display = "inline-block";
      populateItemList();

      spinBtn.focus();
    }

    // Hi·ªÉn th·ªã m√†n ch·ªçn l·∫°i
    function showSelectionScreen() {
      selectionScreen.style.display = "block";
      wheelScreen.style.display = "none";
      resultTab.style.display = "none";
      backBtn.style.display = "none";
      manageSection.style.display = "none";
      editingIndex = -1;
      btnPlace.setAttribute('aria-pressed','false');
      btnFood.setAttribute('aria-pressed','false');
      btnPlace.focus();
    }

    // Hi·ªÉn th·ªã danh s√°ch item v·ªõi n√∫t s·ª≠a x√≥a
    function populateItemList() {
      itemList.innerHTML = '';
      if (currentItems.length === 0) {
        const li = document.createElement('li');
        li.textContent = '(Danh s√°ch tr·ªëng)';
        li.style.fontStyle = 'italic';
        li.style.color = '#a57d8d';
        itemList.appendChild(li);
        return;
      }

      currentItems.forEach((item, index) => {
        const li = document.createElement('li');
        const span = document.createElement('span');
        span.className = 'text-item';
        span.textContent = item;
        li.appendChild(span);

        const editBtn = document.createElement('button');
        editBtn.className = 'btn-edit';
        editBtn.textContent = 'S·ª≠a';
        editBtn.setAttribute('aria-label', `S·ª≠a m·ª•c ${item}`);
        editBtn.addEventListener('click', () => {
          startEditingItem(index);
        });
        li.appendChild(editBtn);

        const delBtn = document.createElement('button');
        delBtn.className = 'btn-delete';
        delBtn.textContent = 'X√≥a';
        delBtn.setAttribute('aria-label', `X√≥a m·ª•c ${item}`);
        delBtn.addEventListener('click', () => {
          if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a "${item}" kh√¥ng?`)) {
            deleteItem(index);
          }
        });
        li.appendChild(delBtn);

        itemList.appendChild(li);
      });
    }

    // B·∫Øt ƒë·∫ßu ch·ªânh s·ª≠a m·ªôt item
    function startEditingItem(index) {
      editingIndex = index;
      editInput.value = currentItems[index];
      editForm.style.display = "flex";
      addItemBtn.style.display = "none";
      editInput.focus();
    }

    // Th√™m m·ª•c m·ªõi
    function startAddingItem() {
      editingIndex = -1;
      editInput.value = '';
      editForm.style.display = "flex";
      addItemBtn.style.display = "none";
      editInput.focus();
    }

    // L∆∞u sau khi th√™m ho·∫∑c s·ª≠a
    function saveItem(text) {
      text = text.trim();
      if (!text) {
        alert('N·ªôi dung kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!');
        return false;
      }
      // Ki·ªÉm tra tr√πng t√™n
      if (currentItems.some((item, idx) => item.toLowerCase() === text.toLowerCase() && idx !== editingIndex)) {
        alert('M·ª•c n√†y ƒë√£ t·ªìn t·∫°i trong danh s√°ch!');
        return false;
      }

      if (editingIndex === -1) {
        // Th√™m m·ªõi
        currentItems.push(text);
      } else {
        // S·ª≠a
        currentItems[editingIndex] = text;
      }
      saveData(currentType, currentItems);
      populateItemList();
      editForm.style.display = "none";
      addItemBtn.style.display = "inline-block";
      drawWheel();
      editingIndex = -1;
      return true;
    }

    // X√≥a m·ª•c
    function deleteItem(index) {
      currentItems.splice(index, 1);
      saveData(currentType, currentItems);
      populateItemList();
      drawWheel();
    }

    // S·ª± ki·ªán n√∫t th√™m m·ª•c m·ªõi
    addItemBtn.addEventListener('click', startAddingItem);

    // S·ª± ki·ªán form l∆∞u
    editForm.addEventListener('submit', e => {
      e.preventDefault();
      if (saveItem(editInput.value)) {
        spinBtn.focus();
      }
    });

    // N√∫t h·ªßy ch·ªânh s·ª≠a
    cancelBtn.addEventListener('click', () => {
      editForm.style.display = "none";
      addItemBtn.style.display = "inline-block";
      editingIndex = -1;
      spinBtn.focus();
    });

    // C√°c n√∫t ch·ªçn lo·∫°i
    btnPlace.addEventListener('click', () => {
      btnPlace.setAttribute('aria-pressed', 'true');
      btnFood.setAttribute('aria-pressed', 'false');
      showWheelScreen('place');
    });

    btnFood.addEventListener('click', () => {
      btnFood.setAttribute('aria-pressed', 'true');
      btnPlace.setAttribute('aria-pressed', 'false');
      showWheelScreen('food');
    });

    // N√∫t quay b√°nh xe
    spinBtn.addEventListener('click', () => {
      if (spinning) return;
      if (currentItems.length === 0) {
        alert('Danh s√°ch hi·ªán t·∫°i ƒëang tr·ªëng. Vui l√≤ng th√™m m·ª•c m·ªõi tr∆∞·ªõc khi quay!');
        return;
      }
      spinBtn.disabled = true;
      resultTab.style.display = "none";
      spinning = true;
      spinArcStart = Math.floor(Math.random() * 360) + 360 * 3;
      spinTime = 0;
      spinTimeTotal = Math.floor(Math.random() * 2000) + 4000;
      rotateWheel();
    });

    // N√∫t quay l·∫°i
    backBtn.addEventListener('click', () => {
      clearTimeout(spinTimeout);
      spinning = false;
      spinBtn.disabled = false;
      showSelectionScreen();
    });

    // Kh·ªüi t·∫°o app
    function init() {
      showSelectionScreen();
    }

    // Kh·ªüi ƒë·ªông
    init();

  </script>
</body>
</html>
